<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>AGENTS.md • lese</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="AGENTS.md"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">lese</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>AGENTS.md</h1>

    </div>

<div id="agentsmd" class="section level1">

<p>Project guide for contributors and AI agents working on the <code>lese</code> R package and lecture service infrastructure.</p>
<div class="section level2">
<h2 id="what-this-project-does">What This Project Does<a class="anchor" aria-label="anchor" href="#what-this-project-does"></a></h2>
<p>This is a <strong>dual-purpose</strong> repository:</p>
<ol style="list-style-type: decimal"><li>
<strong>R package (<code>lese</code>)</strong> — functions for compiling, checking, and auditing lecture slides across multiple LaTeX-based lecture repositories</li>
<li>
<strong>Service repository</strong> — central hub that clones lecture repos (<code>lecture_i2ml</code>, <code>lecture_sl</code>, …) and syncs shared infrastructure (Makefiles, LaTeX styles, GitHub Actions workflows) to them</li>
</ol><p>The lecture repos are <strong>not</strong> in this git tree. They are cloned/symlinked as sibling directories (e.g. <code>lecture_service/lecture_i2ml/</code>).</p>
</div>
<div class="section level2">
<h2 id="project-layout">Project Layout<a class="anchor" aria-label="anchor" href="#project-layout"></a></h2>
<div class="section level3">
<h3 id="this-repository">This Repository<a class="anchor" aria-label="anchor" href="#this-repository"></a></h3>
<pre><code>lecture_service/
├── R/                    # R package source (the lese package)
├── man/                  # Generated roxygen2 docs (do not edit manually)
├── inst/                 # Package-installed files
│   ├── lecheck           # CLI tool (docopt-based)
│   ├── check_status.R    # CI exit-code script
│   ├── chapter_audit.Rmd # Audit report template
│   ├── slide_status.Rmd  # HTML status site template
│   └── slide_status_pr.Rmd  # PR comment table template
├── service/              # Files synced TO lecture repos
│   ├── Makefile          # Lecture-level Makefile template
│   ├── style/            # LaTeX style files (preamble, .sty packages)
│   ├── scripts/          # Lecture-level scripts (update-service.sh, etc.)
│   ├── slides/
│   │   ├── tex.mk        # Chapter-level Makefile (included by slides/&lt;ch&gt;/Makefile)
│   │   └── R.mk          # rsrc-level Makefile (included by slides/&lt;ch&gt;/rsrc/Makefile)
│   └── .github/workflows/  # CI workflow templates for lectures
├── scripts/              # Service-level scripts (clone, download, install)
├── Makefile              # Orchestration Makefile for lecture_service itself
├── DESCRIPTION           # R package metadata
└── NAMESPACE             # Generated (devtools::document)</code></pre>
</div>
<div class="section level3">
<h3 id="individual-lecture-repositories">Individual Lecture Repositories<a class="anchor" aria-label="anchor" href="#individual-lecture-repositories"></a></h3>
<p>Each lecture repository (e.g. <code>lecture_i2ml</code>) follows a standard structure:</p>
<pre><code>lecture_i2ml/
├── slides/               # Source .tex files organized by chapter
│   ├── ml-basics/
│   │   ├── slides-basics-data.tex
│   │   ├── slides-basics-learner.tex
│   │   ├── figure/       # Generated figures (from rsrc/ scripts)
│   │   ├── figure_man/   # Manually created figures
│   │   ├── rsrc/         # R scripts that generate figures
│   │   └── Makefile      # One-liner: include ../tex.mk
│   └── tex.mk            # Symlinked/copied from service/slides/tex.mk
├── slides-pdf/           # "Known good" PDFs for comparison
├── style/                # Synced from lecture_service/service/style/
├── latex-math/           # Submodule from slds-lmu/latex-math
├── scripts/              # Synced from lecture_service/service/scripts/
├── .github/workflows/    # Synced from lecture_service/service/.github/
└── Makefile              # Top-level targets (synced from service/)</code></pre>
<p><strong>Naming conventions:</strong> - Slide files: <code>slides-&lt;chapter&gt;-&lt;name&gt;.tex</code> (some lectures use numbered prefixes, not yet universal) - Chapters correspond to <code>slides/</code> subdirectories - Excluded directories: <code>attic</code>, <code>rsrc</code>, <code>all</code>, <code>figure</code>, <code>figure_man</code>, <code>backup</code> - Excluded files: <code>chapter-order*.tex</code>, <code>OLD-*</code>, <code>TO-DO*</code>, <code>TODO*</code></p>
</div>
</div>
<div class="section level2">
<h2 id="key-concepts">Key Concepts<a class="anchor" aria-label="anchor" href="#key-concepts"></a></h2>
<div class="section level3">
<h3 id="the-three-levels">The Three Levels<a class="anchor" aria-label="anchor" href="#the-three-levels"></a></h3>
<p>Everything operates at three nested levels:</p>
<table class="table"><colgroup><col width="8%"><col width="28%"><col width="17%"><col width="46%"></colgroup><thead><tr class="header"><th>Level</th>
<th>Directory example</th>
<th>Makefile</th>
<th>What happens here</th>
</tr></thead><tbody><tr class="odd"><td><strong>Lecture</strong></td>
<td><code>lecture_i2ml/</code></td>
<td><code>service/Makefile</code></td>
<td>
<code>make audit</code>, <code>make slides</code> (all chapters), <code>make install-lese</code>
</td>
</tr><tr class="even"><td><strong>Chapter</strong></td>
<td><code>lecture_i2ml/slides/evaluation/</code></td>
<td><code>service/slides/tex.mk</code></td>
<td>
<code>make slides</code>, <code>make audit</code>, <code>make check-repro</code>
</td>
</tr><tr class="odd"><td><strong>rsrc</strong></td>
<td><code>lecture_i2ml/slides/evaluation/rsrc/</code></td>
<td><code>service/slides/R.mk</code></td>
<td>
<code>make all</code> (run scripts), <code>make deps</code>
</td>
</tr></tbody></table><p>Chapter Makefiles are one-liners (<code>include ../tex.mk</code>), <code>rsrc</code> Makefiles are one-liners (<code>include ../../R.mk</code>).</p>
</div>
<div class="section level3">
<h3 id="figure-audit-data-flow">Figure Audit Data Flow<a class="anchor" aria-label="anchor" href="#figure-audit-data-flow"></a></h3>
<pre><code>rsrc/*.R scripts  →  figure/*.png  →  slides-*.tex  →  .fls files (from latexmk)
                          ↑                                    ↓
                    audit_chapter() cross-references these to find:
                    - orphaned figures (on disk, not in any slide)
                    - missing figures (in slide, not on disk)
                    - attic figures (in figure/attic/, informational only)</code></pre>
<p>Two detection methods: - <strong>regex</strong>: parses <code>.tex</code> source for <code>\includegraphics</code> etc. Fast but misses dynamic paths. - <strong>fls</strong>: reads <code>.fls</code> recorder files from <code>latexmk -recorder</code>. More accurate (respects comments, <code>\iffalse</code> conditionals). Requires prior <code>make slides</code>. - <strong>auto</strong> (default): uses fls if all <code>.fls</code> files exist, otherwise regex.</p>
</div>
<div class="section level3">
<h3 id="service-sync-mechanism">Service Sync Mechanism<a class="anchor" aria-label="anchor" href="#service-sync-mechanism"></a></h3>
<p>Lectures pull updates from <code>lecture_service</code> via <code>bash scripts/update-service.sh [branch]</code>: - Downloads tarball from GitHub API - <code>rsync --delete</code> for <code>style/</code> (strict sync) - Copies <code>scripts/</code>, <code>.github/</code>, <code>Makefile</code></p>
<p>This means changes to <code>service/</code> files propagate to lectures only when they explicitly run the update script.</p>
</div>
</div>
<div class="section level2">
<h2 id="r-package-architecture">R Package Architecture<a class="anchor" aria-label="anchor" href="#r-package-architecture"></a></h2>
<div class="section level3">
<h3 id="function-categories">Function Categories<a class="anchor" aria-label="anchor" href="#function-categories"></a></h3>
<p><strong>Discovery</strong>: <code><a href="reference/lectures.html">lectures()</a></code>, <code><a href="reference/collect_lectures.html">collect_lectures()</a></code>, <code><a href="reference/find_slide_tex.html">find_slide_tex()</a></code> — find lectures and slides</p>
<p><strong>Compilation</strong>: <code><a href="reference/compile_slide.html">compile_slide()</a></code> dispatches to <code><a href="reference/latexmk_system.html">latexmk_system()</a></code> / <code><a href="reference/latexmk_docker.html">latexmk_docker()</a></code> / <code><a href="reference/latexmk_tinytex.html">latexmk_tinytex()</a></code></p>
<p><strong>Checking</strong>: <code><a href="reference/check_slides_single.html">check_slides_single()</a></code>, <code><a href="reference/check_slides_many.html">check_slides_many()</a></code> (parallel via <code>future.apply</code>), <code><a href="reference/compare_slide.html">compare_slide()</a></code> (uses <code>diff-pdf-visually</code>)</p>
<p><strong>Auditing</strong>: <code><a href="reference/audit_chapter.html">audit_chapter()</a></code>, <code><a href="reference/clean_orphaned_figures.html">clean_orphaned_figures()</a></code>, <code><a href="reference/render_chapter_audit.html">render_chapter_audit()</a></code></p>
<p><strong>Scripts</strong>: <code><a href="reference/run_script.html">run_script()</a></code>, <code><a href="reference/run_chapter_scripts.html">run_chapter_scripts()</a></code> — isolated <code><a href="https://callr.r-lib.org/reference/r.html" class="external-link">callr::r()</a></code> subprocesses</p>
<p><strong>Dependencies</strong>: <code><a href="reference/extract_script_deps.html">extract_script_deps()</a></code>, <code><a href="reference/check_script_deps.html">check_script_deps()</a></code>, <code><a href="reference/check_lecture_deps.html">check_lecture_deps()</a></code></p>
<p><strong>Reporting</strong>: <code><a href="reference/render_slide_status.html">render_slide_status()</a></code>, <code><a href="reference/render_slide_status_pr.html">render_slide_status_pr()</a></code> — render Rmd templates from <code>inst/</code></p>
</div>
<div class="section level3">
<h3 id="internal-helpers-not-exported">Internal Helpers (not exported)<a class="anchor" aria-label="anchor" href="#internal-helpers-not-exported"></a></h3>
<ul><li>
<code>check_lecture_dir()</code> — validates lecture directory, auto-discovers via <code><a href="https://here.r-lib.org/reference/here.html" class="external-link">here::here()</a></code>
</li>
<li>
<code>get_chapter_figures()</code> — lists files in <code>figure/</code> and <code>figure_man/</code> with metadata</li>
<li>
<code>get_chapter_scripts()</code> — lists <code>.R</code> files in <code>rsrc/</code>
</li>
<li>
<code>parse_fls_figures()</code> — parses <code>.fls</code> recorder files for figure paths</li>
<li>
<code>is_pkg_installed()</code> — checks package availability without loading namespace</li>
</ul></div>
<div class="section level3">
<h3 id="slide-cache">Slide Cache<a class="anchor" aria-label="anchor" href="#slide-cache"></a></h3>
<ul><li>Stored in <code>rappdirs::user_data_dir("lese")</code>, NOT in the repo</li>
<li>
<code>.slide_check_stamp</code> stamp file in repo root tracks freshness</li>
<li>
<code><a href="reference/slide_cache_path.html">slide_cache_path()</a></code> / <code><a href="reference/slide_cache_clean.html">slide_cache_clean()</a></code> manage it</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a></h2>
<p>There are three layers of documentation:</p>
<ol style="list-style-type: decimal"><li>
<p><strong>GitHub Wiki</strong> (<code>lecture_service.wiki/</code>) — the primary user-facing documentation, living at <a href="https://github.com/slds-lmu/lecture_service/wiki" class="external-link uri">https://github.com/slds-lmu/lecture_service/wiki</a>. The wiki is cloned as a sibling repo at <code>lecture_service.wiki/</code>. It targets two audiences:</p>
<ul><li>
<strong>Lecture authors</strong>: how to write slides, use custom LaTeX environments, compile locally, record videos, manage Overleaf sync</li>
<li>
<strong>Infrastructure maintainers</strong>: how the service repo works, CI workflows, CLI tools, figure audit and reproducibility checks</li>
</ul><p>Key wiki pages: | Page | Audience | Covers | | ————————————– | ———– | ——————————————————————————————- | | Slides | Authors | Slide structure, custom environments (<code>framei</code>/<code>framev</code>), layout macros, content guidelines | | Slide-Code-Guide | Authors | Best practices for R scripts in <code>rsrc/</code> (reproducibility, naming, plotting) | | Slides-Compilation | Both | Compiling slides locally via Makefile or <code>lecheck</code>, Docker support | | Slide-reproducibility-and-unused-files | Maintainers | Figure audit, orphaned/missing detection, <code>check-repro</code>, <code>clean-orphaned-figures</code> | | lecture_service | Maintainers | Service repo setup, LaTeX style files, CI workflows | | lecheck-cli | Maintainers | CLI tool documentation | | GitHub-Actions | Maintainers | Automated workflows (slide checks, PR comments, latex-math updates) | | Publishing-Content | Maintainers | Publishing slides, exercises, literature lists to course websites | | latex-math | Both | Shared notation repository, adding/updating macros | | Overleaf-and-GitHub-Integration | Authors | Syncing Overleaf and GitHub, handling line endings |</p>
</li>
<li><p><strong>pkgdown site</strong> (<a href="https://slds-lmu.github.io/lecture_service/" class="uri">https://slds-lmu.github.io/lecture_service/</a>) — auto-generated R package API reference from roxygen2 docs in <code>R/</code> files</p></li>
<li><p><strong>AGENTS.md</strong> (this file) — technical context for AI agents and contributors working on the codebase itself. CLAUDE.md points here.</p></li>
</ol><p>When adding new features or changing behavior, update both the relevant wiki page(s) and the R package documentation (roxygen2 + <code>NEWS.md</code>).</p>
</div>
<div class="section level2">
<h2 id="development-workflow">Development Workflow<a class="anchor" aria-label="anchor" href="#development-workflow"></a></h2>
<div class="section level3">
<h3 id="after-editing-r-files">After editing R files<a class="anchor" aria-label="anchor" href="#after-editing-r-files"></a></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">air</span> format R/modified-file.R    <span class="co"># format with air</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">'devtools::document()'</span>  <span class="co"># regenerate NAMESPACE + man/</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">'devtools::check()'</span>     <span class="co"># or devtools::test() for faster feedback</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="key-conventions">Key conventions<a class="anchor" aria-label="anchor" href="#key-conventions"></a></h3>
<ul><li>Use <code>cli</code> package for user-facing messages (never <code><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat()</a></code> or <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>)</li>
<li>Avoid <code><a href="https://rdrr.io/r/base/function.html" class="external-link">return()</a></code> at end of functions (only for early returns)</li>
<li>Use <code>data.table</code> in package code for performance; <code>dplyr</code>/tidyverse ok in Rmd templates</li>
<li>testthat 3e for tests</li>
<li>
<code>latexmk -pdf -halt-on-error</code> for LaTeX compilation</li>
</ul></div>
<div class="section level3">
<h3 id="testing-changes-to-makefiles">Testing changes to Makefiles<a class="anchor" aria-label="anchor" href="#testing-changes-to-makefiles"></a></h3>
<p>Makefiles in <code>service/</code> are templates. To test locally: 1. Edit <code>service/slides/tex.mk</code> (or <code>service/Makefile</code>, etc.) 2. In a lecture repo: <code>bash scripts/update-service.sh figure-repro</code> (or your branch) 3. Test the targets there</p>
</div>
<div class="section level3">
<h3 id="adding-a-new-exported-function">Adding a new exported function<a class="anchor" aria-label="anchor" href="#adding-a-new-exported-function"></a></h3>
<ol style="list-style-type: decimal"><li>Add the function in <code>R/&lt;appropriate-file&gt;.R</code> with roxygen2 docs and <code>@export</code>
</li>
<li>Run <code>devtools::document()</code> to update NAMESPACE and generate man page</li>
<li>Add entry to <code>_pkgdown.yml</code> in the appropriate section</li>
<li>Add entry to <code>NEWS.md</code> under the dev version header</li>
<li>Run <code>devtools::check()</code> to verify</li>
</ol></div>
</div>
<div class="section level2">
<h2 id="ci-workflows">CI Workflows<a class="anchor" aria-label="anchor" href="#ci-workflows"></a></h2>
<div class="section level3">
<h3 id="for-lecture_service-itself">For lecture_service itself<a class="anchor" aria-label="anchor" href="#for-lecture_service-itself"></a></h3>
<ul><li>
<code>R-CMD-check.yaml</code> — standard R package checks</li>
<li>
<code>pkgdown.yaml</code> — builds docs site at <a href="https://slds-lmu.github.io/lecture_service/" class="uri">https://slds-lmu.github.io/lecture_service/</a>
</li>
</ul></div>
<div class="section level3">
<h3 id="templates-synced-to-lectures-servicegithubworkflows">Templates synced to lectures (<code>service/.github/workflows/</code>)<a class="anchor" aria-label="anchor" href="#templates-synced-to-lectures-servicegithubworkflows"></a></h3>
<ul><li>
<code>pr-slide-check.yaml</code> — on PRs: compile affected slides, post results as PR comment</li>
<li>
<code>render-lecture-slide-status.yaml</code> — on push to main: compile all slides, deploy HTML status site to GitHub Pages</li>
</ul><p>Both share the pattern: checkout lecture_service at root, checkout lecture as subdirectory, dual cache (R packages + TinyTeX), then run make targets.</p>
</div>
</div>
<div class="section level2">
<h2 id="latex-style-files">LaTeX Style Files<a class="anchor" aria-label="anchor" href="#latex-style-files"></a></h2>
<p><strong>Location:</strong> <code>service/style/</code> (synced to <code>lecture_*/style/</code>)</p>
<ul><li>
<strong><code>preamble.tex</code></strong> — main preamble loaded by all slides</li>
<li>
<strong><code>lmu-lecture.sty</code></strong> — main beamer theme; handles margin vs no-margin switching via <code>nospeakermargin.tex</code>
</li>
<li>
<strong><code>framei.sty</code></strong> — enhanced frame with automatic itemize wrapper (<code>fs</code>, <code>sep</code>, <code>align</code> options)</li>
<li>
<strong><code>framev.sty</code></strong> — vanilla frame without itemize, replaces old <code>frame2</code> (<code>fs</code>, <code>align</code> options)</li>
<li>
<strong><code>image.sty</code></strong> — <code>\image</code>, <code>\imageC</code>, <code>\imageFixed</code> macros for <code>\includegraphics</code>
</li>
<li>
<strong><code>customitemize.sty</code></strong> — <code>itemizeS</code>/<code>itemizeM</code>/<code>itemizeL</code> etc. with font size control</li>
<li>
<strong><code>splitV.sty</code></strong> — <code>\splitVCC</code>, <code>\splitVTT</code> etc. for column layouts</li>
<li>
<strong><code>ref-buttons.sty</code></strong> — <code>\furtherreading{}</code>, <code>\sourceref{}</code>, <code>\citelink{}</code>
</li>
</ul></div>
<div class="section level2">
<h2 id="external-dependencies">External Dependencies<a class="anchor" aria-label="anchor" href="#external-dependencies"></a></h2>
<ul><li>
<strong>R packages</strong>: cli, dplyr, fs, git2r, processx, tinytex, future.apply, callr, data.table, rappdirs</li>
<li>
<strong>LaTeX</strong>: TinyTeX or full TeX Live distribution</li>
<li>
<strong>Tools</strong> (optional): <code>diff-pdf</code>, <code>diff-pdf-visually</code> (for slide comparison), <code>pdfannotextractor</code> (pax, for hyperlink preservation)</li>
<li>
<strong>Docker</strong> (optional): GitLab TeX Live images for reproducible compilation</li>
</ul></div>
<div class="section level2">
<h2 id="common-tasks">Common Tasks<a class="anchor" aria-label="anchor" href="#common-tasks"></a></h2>
<div class="section level3">
<h3 id="adding-a-new-lecture">Adding a new lecture<a class="anchor" aria-label="anchor" href="#adding-a-new-lecture"></a></h3>
<ol style="list-style-type: decimal"><li>Clone/download repo to <code>lecture_service/</code>
</li>
<li>Add to <code>include_lectures</code> file</li>
<li>Run <code>make site</code> to include in checks</li>
</ol></div>
<div class="section level3">
<h3 id="updating-style-files">Updating style files<a class="anchor" aria-label="anchor" href="#updating-style-files"></a></h3>
<ol style="list-style-type: decimal"><li>Edit files in <code>service/style/</code>
</li>
<li>Test locally in a lecture repo</li>
<li>Lectures pull updates via <code>bash scripts/update-service.sh</code>
</li>
</ol></div>
<div class="section level3">
<h3 id="debugging-failed-slides">Debugging failed slides<a class="anchor" aria-label="anchor" href="#debugging-failed-slides"></a></h3>
<ol style="list-style-type: decimal"><li>Check GitHub Pages status site: <code>https://slds-lmu.github.io/{lecture_name}/</code>
</li>
<li>Review comparison PDFs for visual diffs</li>
<li>Check LaTeX logs in workflow output</li>
<li>Compile locally: <code>lecheck compile lecture_name chapter_name slide_name</code>
</li>
</ol></div>
</div>
<div class="section level2">
<h2 id="known-gotchas">Known Gotchas<a class="anchor" aria-label="anchor" href="#known-gotchas"></a></h2>
<div class="section level3">
<h3 id="beamer-environment-naming">Beamer environment naming<a class="anchor" aria-label="anchor" href="#beamer-environment-naming"></a></h3>
<p><strong>NEVER</strong> name custom beamer environments <code>frame&lt;digit&gt;</code> (e.g. <code>frame2</code>, <code>frame3</code>). This triggers beamer’s internal frame parser and causes cryptic “Use of doesn’t match its definition” errors.</p>
<ul><li>Bad: <code>frame2</code>, <code>frame3</code>, <code>frame123</code>
</li>
<li>Good: <code>framei</code>, <code>framev</code>, <code>myframe</code>, <code>customframe</code>
</li>
</ul><p><strong>Root cause</strong>: When <code>\NewEnviron{frame2}</code> is defined, LaTeX creates internal macros including <code>\frame2</code>. Beamer’s parser scans for <code>\frame</code> + digit patterns and mistakes this for a malformed frame command. The conflict is latent in the name but only manifests when <code>keyval</code> processing is involved (e.g. adding <code>\define@key</code> options). This is why <code>frame2</code> used to work with simple font-size passthrough but broke when alignment options were added.</p>
<p><strong>If you see this error</strong>: Check if the environment name matches <code>frame&lt;digit&gt;</code>. Rename to use letters. Don’t debug keyval syntax — it’s not the issue.</p>
</div>
<div class="section level3">
<h3 id="fls-vs-regex-figure-detection">
<code>.fls</code> vs regex figure detection<a class="anchor" aria-label="anchor" href="#fls-vs-regex-figure-detection"></a></h3>
<p>A figure can appear orphaned with <code>.fls</code> method even though it’s in the <code>.tex</code> source if: - The <code>\includegraphics</code> is commented out (<code>%</code>) - It’s inside <code>\iffalse...\fi</code> or <code>\if0...\fi</code> (disabled conditional) - The <code>.fls</code> file is stale (re-run <code>make slides</code>)</p>
<p>This is correct behavior — <code>.fls</code> reflects what LaTeX <em>actually read</em>.</p>
</div>
<div class="section level3">
<h3 id="herehere-in-lecture-context">
<code>here::here()</code> in lecture context<a class="anchor" aria-label="anchor" href="#herehere-in-lecture-context"></a></h3>
<p>Most functions default <code>lecture_dir = here::here()</code>. This works when the working directory is anywhere inside a lecture repo (thanks to <code>.here</code> or <code>.git</code> markers). When working from <code>lecture_service/</code>, you must pass <code>lecture_dir</code> explicitly.</p>
</div>
<div class="section level3">
<h3 id="symlinked-lectures">Symlinked lectures<a class="anchor" aria-label="anchor" href="#symlinked-lectures"></a></h3>
<p><code><a href="reference/collect_lectures.html">collect_lectures()</a></code> uses <code>fs::dir_ls(..., type = "any")</code> to discover lecture directories, supporting symlinks. This was a past bug — <code>type = "directory"</code> skipped symlinks.</p>
</div>
<div class="section level3">
<h3 id="package-installation-checks">Package installation checks<a class="anchor" aria-label="anchor" href="#package-installation-checks"></a></h3>
<p><code>is_pkg_installed()</code> uses <code><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace(quietly = TRUE)</a></code> to check without loading, avoiding namespace conflict warnings (e.g. mlr3 vs mlr). Never use <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> for checking.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Burk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

